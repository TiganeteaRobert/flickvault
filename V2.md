# Movie Manager V2

## Overview

V2 transforms Movie Manager from a basic CRUD app into a modern, AI-powered movie collection manager. Users can describe a collection in natural language and have Claude build it automatically, while enjoying a redesigned UI with rich movie cards featuring posters and plot summaries.

---

## Feature 1: AI-Powered Collection Creation

### What
An input box on the home page where users describe the collection they want (e.g. "Top 10 sci-fi movies from the 90s") along with a dropdown to select movie count. On submit, Claude generates the collection with matching movies.

### Backend
- New endpoint: `POST /api/collections/generate`
  - Accepts `{ "prompt": str, "movie_count": int }`
  - Calls Claude API (Anthropic SDK) with a system prompt that instructs it to return structured JSON: collection name, description, and a list of movies (title, year, overview)
  - For each movie returned by Claude, search TMDB API to fetch `poster_url`, `tmdb_id`, and `imdb_id`
  - Creates the collection and movies in the database using existing CRUD functions
  - Returns the created collection
- New dependency: `anthropic` Python SDK
- New dependency: TMDB API integration (for poster/metadata enrichment)
- Environment variables: `ANTHROPIC_API_KEY`, `TMDB_API_KEY`

### Frontend
- New section at the top of the home page: "Ask Claude to build a collection"
  - Text input for the prompt
  - Dropdown for movie count (5, 10, 15, 20, 25)
  - Submit button with loading state (spinner + "Claude is thinking...")
- On success: redirect to the new collection's detail page
- On error: show inline error message

### MCP Server
- New MCP tool: `generate_collection` — so Claude can also trigger AI collection creation from the MCP interface

---

## Feature 2: Modern UI Redesign

### What
Replace the current minimal Pico.css-based UI with a modern, visually polished design.

### Changes
- Switch from Pico.css to a custom design using Tailwind CSS (via CDN)
- Dark theme by default with a light/dark toggle
- Home page:
  - Hero section with the AI collection builder prominently featured
  - Collection cards in a responsive grid with hover effects and movie count badges
  - Smooth transitions and subtle animations
- Collection detail page:
  - Header with collection name, description, and stats
  - Movie grid (cards instead of a table)
  - Each card shows poster, title, year, and a truncated overview
- Consistent typography, spacing, and color palette throughout
- Mobile-responsive layout

### Files to modify
- `app/templates/base.html` — new base layout with Tailwind, nav bar, dark mode toggle
- `app/templates/index.html` — redesigned home page
- `app/templates/collection.html` — card-based movie grid
- `app/templates/import.html` — styled to match
- `app/static/` — any custom CSS or JS needed beyond Tailwind

---

## Feature 3: Movie Thumbnails & Plot Descriptions

### What
Each movie displays its poster thumbnail and a plot summary on the collection detail page.

### Backend
- When adding movies (both manual and AI-generated), fetch poster and overview from TMDB API if not already present
- New utility: `app/tmdb.py` — TMDB API client
  - `search_movie(title, year)` → returns poster_url, overview, tmdb_id, imdb_id
  - Uses `poster_url` field already on the Movie model (currently unused)
  - Uses `overview` field already on the Movie model
- Backfill endpoint (optional): `POST /api/movies/enrich` to populate poster/overview for existing movies missing them

### Frontend (collection detail page)
- Replace the table layout with a card grid
- Each movie card:
  - Left/top: poster thumbnail (fallback to a placeholder if missing)
  - Right/bottom: title, year, full plot overview
  - IMDb link button
  - Remove button

---

## Implementation Order

1. **TMDB integration** (`app/tmdb.py`) — needed by both AI generation and thumbnail features
2. **AI collection generation** — backend endpoint + Anthropic SDK integration
3. **UI redesign** — Tailwind migration, new layouts for all pages
4. **Wire it all together** — AI builder on home page, movie cards with posters/plots

---

## New Dependencies

| Package | Purpose |
|---------|---------|
| `anthropic` | Claude API SDK for AI collection generation |
| `httpx` | Already installed — used for TMDB API calls |

## Environment Variables

| Variable | Purpose |
|----------|---------|
| `ANTHROPIC_API_KEY` | Claude API access |
| `TMDB_API_KEY` | Movie poster & metadata lookup |
